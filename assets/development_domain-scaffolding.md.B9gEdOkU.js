import{_ as d,I as r,c as p,o as c,av as o,J as a,j as e,w as l,a as s}from"./chunks/framework.Cef0v0Gn.js";const C=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"development/domain-scaffolding.md","filePath":"development/domain-scaffolding.md"}'),h={name:"development/domain-scaffolding.md"};function g(u,t,A,m,k,f){const i=r("MermaidChart"),n=r("ClientOnly");return c(),p("div",null,[t[0]||(t[0]=o('<p>To accelerate development and maintain consistency across domain modules, the project includes a CLI generator tool that creates complete CRUD domains in seconds. It also automatically registers the new routes and formats the code.</p><blockquote><p><strong>üí° Want to understand how the generator works internally?</strong><br> See <a href="./template-system-architecture.html">Template System Architecture</a> for a deep dive into the zero-dependency template engine.</p></blockquote><h2 id="how-to-use" tabindex="-1">How to use <a class="header-anchor" href="#how-to-use" aria-label="Permalink to ‚ÄúHow to use‚Äù">‚Äã</a></h2><p>Run the following command in your terminal:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gen:domain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div><p>Replace <code>&lt;name&gt;</code> with the singular name of your domain (e.g., <code>product</code>, <code>category</code>, <code>order</code>). The name will be used to:</p><ul><li>Create the domain folder structure</li><li>Name the database table (e.g., <code>product</code> ‚Üí table <code>product</code>)</li><li>Generate proper imports and references</li><li>Create Swagger tags with capitalized names (e.g., <code>Product</code>)</li></ul><h2 id="generated-structure" tabindex="-1">Generated Structure <a class="header-anchor" href="#generated-structure" aria-label="Permalink to ‚ÄúGenerated Structure‚Äù">‚Äã</a></h2><p>The tool automatically creates a <strong>complete CRUD structure</strong> following the project&#39;s architectural patterns:</p>',9)),a(n,null,{default:l(()=>[a(i,{code:"graph%20TD%0A%20%20%20%20A%5Bbun%20gen%3Adomain%20product%5D%20--%3E%20B%5Bsrc%2Fdomain%2Fproduct%2F%5D%0A%20%20%20%20A%20--%3E%20C%5Btests%2Funit%2Fdomain%2Fproduct%2F%5D%0A%20%20%20%20%0A%20%20%20%20B%20--%3E%20D%5Bentity.ts%5D%0A%20%20%20%20B%20--%3E%20E%5Bschema.ts%5D%0A%20%20%20%20B%20--%3E%20F%5Broutes.ts%5D%0A%20%20%20%20B%20--%3E%20G%5Bactions%2F%5D%0A%20%20%20%20%0A%20%20%20%20G%20--%3E%20H%5Bget-by-id.ts%5D%0A%20%20%20%20G%20--%3E%20I%5Bget-find-by-params.ts%5D%0A%20%20%20%20G%20--%3E%20J%5Bpost-new-entity.ts%5D%0A%20%20%20%20G%20--%3E%20K%5Bput-update-entity.ts%5D%0A%20%20%20%20G%20--%3E%20L%5Bdelete-entity.ts%5D%0A%20%20%20%20%0A%20%20%20%20C%20--%3E%20M%5Bcrud.spec.ts%5D%0A%0A%20%20%20%20F%20-.-%3E%20F1%5BSwagger%20Tags%5D%0A%20%20%20%20F%20-.-%3E%20F2%5BResponse%20Schemas%5D%0A%20%20%20%20%0A%20%20%20%20style%20A%20fill%3A%234CAF50%2Cstroke%3A%23333%2Cstroke-width%3A2px%2Ccolor%3A%23fff%0A%20%20%20%20style%20B%20fill%3A%232196F3%2Cstroke%3A%23333%2Cstroke-width%3A2px%2Ccolor%3A%23fff%0A%20%20%20%20style%20C%20fill%3A%23FF9800%2Cstroke%3A%23333%2Cstroke-width%3A2px%2Ccolor%3A%23fff%0A%20%20%20%20style%20F1%20fill%3A%239C27B0%2Cstroke%3A%23333%2Cstroke-width%3A1px%2Ccolor%3A%23fff%2Cstroke-dasharray%3A%205%205%0A%20%20%20%20style%20F2%20fill%3A%239C27B0%2Cstroke%3A%23333%2Cstroke-width%3A1px%2Ccolor%3A%23fff%2Cstroke-dasharray%3A%205%205%0A",showToolbar:"1"})]),_:1}),t[1]||(t[1]=o('<h3 id="file-details" tabindex="-1">File Details <a class="header-anchor" href="#file-details" aria-label="Permalink to ‚ÄúFile Details‚Äù">‚Äã</a></h3><h4 id="entity-ts" tabindex="-1"><code>entity.ts</code> <a class="header-anchor" href="#entity-ts" aria-label="Permalink to ‚Äúentity.ts‚Äù">‚Äã</a></h4><p>Drizzle ORM table definition with:</p><ul><li>Column definitions in a <code>columns</code> object</li><li>Table creation with <code>identifier</code> (id, timestamps, activated)</li><li>Index setup using <code>pgIndex</code></li><li>TypeScript type inference from table schema</li></ul><h4 id="schema-ts" tabindex="-1"><code>schema.ts</code> <a class="header-anchor" href="#schema-ts" aria-label="Permalink to ‚Äúschema.ts‚Äù">‚Äã</a></h4><p>Zod validation schemas for all operations:</p><ul><li><strong>headers</strong>: Authentication headers</li><li><strong>id</strong>: UUID validation for params</li><li><strong>read</strong>: Query params with pagination support</li><li><strong>create</strong>: Body validation for POST</li><li><strong>update</strong>: Partial body validation for PUT</li><li><strong>delete</strong>: ID-only validation for DELETE</li></ul><h4 id="routes-ts" tabindex="-1"><code>routes.ts</code> <a class="header-anchor" href="#routes-ts" aria-label="Permalink to ‚Äúroutes.ts‚Äù">‚Äã</a></h4><p>Fastify routes for complete REST API:</p><ul><li><code>GET /ping</code> - Health check</li><li><code>GET /:id</code> - Retrieve single item (restricted)</li><li><code>GET /</code> - List with filters and pagination (restricted)</li><li><code>POST /</code> - Create new item (restricted)</li><li><code>PUT /:id</code> - Update item (restricted)</li><li><code>DELETE /:id</code> - Delete item (restricted)</li></ul><h4 id="actions" tabindex="-1">Actions <a class="header-anchor" href="#actions" aria-label="Permalink to ‚ÄúActions‚Äù">‚Äã</a></h4><h3 id="actions-breakdown" tabindex="-1">Actions Breakdown <a class="header-anchor" href="#actions-breakdown" aria-label="Permalink to ‚ÄúActions Breakdown‚Äù">‚Äã</a></h3><h4 id="_1-retrieve-single-entity" tabindex="-1">1. Retrieve Single Entity <a class="header-anchor" href="#_1-retrieve-single-entity" aria-label="Permalink to ‚Äú1. Retrieve Single Entity‚Äù">‚Äã</a></h4><p><strong>Endpoint:</strong> <code>GET /:id</code><strong>File:</strong> <code>get-by-id.ts</code><strong>Flow:</strong></p>',14)),a(n,null,{default:l(()=>[a(i,{code:"graph%20LR%0A%20%20%20%20A%5BRequest%5D%20--%3E%20B%7BValidate%20Params%7D%0A%20%20%20%20B%20--%3E%20C%7BCheck%20Cache%7D%0A%20%20%20%20C%20--%20Hit%20--%3E%20D%5BReturn%20Cached%5D%0A%20%20%20%20C%20--%20Miss%20--%3E%20E%5BQuery%20DB%5D%0A%20%20%20%20E%20--%3E%20F%5BCache%20Result%5D%0A%20%20%20%20F%20--%3E%20G%5BReturn%20Data%5D%0A%20%20%20%20%0A%20%20%20%20style%20C%20fill%3A%23FF9800%2Cstroke%3A%23333%2Cstroke-width%3A2px%0A%20%20%20%20style%20D%20fill%3A%234CAF50%2Cstroke%3A%23333%2Cstroke-width%3A2px%0A%20%20%20%20style%20E%20fill%3A%232196F3%2Cstroke%3A%23333%2Cstroke-width%3A2px%0A",showToolbar:"1"})]),_:1}),t[2]||(t[2]=e("h4",{id:"_2-list-entities-paginated",tabindex:"-1"},[s("2. List Entities (Paginated) "),e("a",{class:"header-anchor",href:"#_2-list-entities-paginated","aria-label":"Permalink to ‚Äú2. List Entities (Paginated)‚Äù"},"‚Äã")],-1)),t[3]||(t[3]=e("p",null,[e("strong",null,"Endpoint:"),s(),e("code",null,"GET /"),e("strong",null,"File:"),s(),e("code",null,"get-find-by-params.ts"),e("strong",null,"Flow:")],-1)),a(n,null,{default:l(()=>[a(i,{code:"graph%20LR%0A%20%20%20%20A%5BRequest%5D%20--%3E%20B%7BValidate%20Query%7D%0A%20%20%20%20B%20--%3E%20C%7BCheck%20Cache%7D%0A%20%20%20%20C%20--%20Hit%20--%3E%20D%5BReturn%20Cached%5D%0A%20%20%20%20C%20--%20Miss%20--%3E%20E%5BApply%20Filters%5D%0A%20%20%20%20E%20--%3E%20F%5BPaginate%5D%0A%20%20%20%20F%20--%3E%20G%5BCache%20%26%20Return%5D%0A%0A%20%20%20%20style%20C%20fill%3A%23FF9800%2Cstroke%3A%23333%2Cstroke-width%3A2px%0A%20%20%20%20style%20D%20fill%3A%234CAF50%2Cstroke%3A%23333%2Cstroke-width%3A2px%0A%20%20%20%20style%20E%20fill%3A%232196F3%2Cstroke%3A%23333%2Cstroke-width%3A2px%0A",showToolbar:"1"})]),_:1}),t[4]||(t[4]=e("h4",{id:"_3-create-entity",tabindex:"-1"},[s("3. Create Entity "),e("a",{class:"header-anchor",href:"#_3-create-entity","aria-label":"Permalink to ‚Äú3. Create Entity‚Äù"},"‚Äã")],-1)),t[5]||(t[5]=e("p",null,[e("strong",null,"Endpoint:"),s(),e("code",null,"POST /"),e("strong",null,"File:"),s(),e("code",null,"post-new-entity.ts"),e("strong",null,"Flow:")],-1)),a(n,null,{default:l(()=>[a(i,{code:"graph%20LR%0A%20%20%20%20A%5BRequest%5D%20--%3E%20B%7BValidate%20Body%7D%0A%20%20%20%20B%20--%3E%20C%5BInsert%20to%20DB%5D%0A%20%20%20%20C%20--%3E%20D%5BInvalidate%20Cache%5D%0A%20%20%20%20D%20--%3E%20E%5BReturn%20New%20Entity%5D%0A%0A%20%20%20%20style%20C%20fill%3A%232196F3%2Cstroke%3A%23333%2Cstroke-width%3A2px%0A%20%20%20%20style%20D%20fill%3A%23f44336%2Cstroke%3A%23333%2Cstroke-width%3A2px%0A",showToolbar:"1"})]),_:1}),t[6]||(t[6]=e("h4",{id:"_4-update-entity",tabindex:"-1"},[s("4. Update Entity "),e("a",{class:"header-anchor",href:"#_4-update-entity","aria-label":"Permalink to ‚Äú4. Update Entity‚Äù"},"‚Äã")],-1)),t[7]||(t[7]=e("p",null,[e("strong",null,"Endpoint:"),s(),e("code",null,"PUT /:id"),e("strong",null,"File:"),s(),e("code",null,"put-update-entity.ts"),e("strong",null,"Flow:")],-1)),a(n,null,{default:l(()=>[a(i,{code:"graph%20LR%0A%20%20%20%20A%5BRequest%5D%20--%3E%20B%7BValidate%7D%0A%20%20%20%20B%20--%3E%20C%5BUpdate%20DB%5D%0A%20%20%20%20C%20--%3E%20D%5BInvalidate%20Cache%5D%0A%20%20%20%20D%20--%3E%20E%5BReturn%20Updated%5D%0A%0A%20%20%20%20style%20C%20fill%3A%23FF9800%2Cstroke%3A%23333%2Cstroke-width%3A2px%0A%20%20%20%20style%20D%20fill%3A%23f44336%2Cstroke%3A%23333%2Cstroke-width%3A2px%0A",showToolbar:"1"})]),_:1}),t[8]||(t[8]=e("h4",{id:"_5-delete-entity",tabindex:"-1"},[s("5. Delete Entity "),e("a",{class:"header-anchor",href:"#_5-delete-entity","aria-label":"Permalink to ‚Äú5. Delete Entity‚Äù"},"‚Äã")],-1)),t[9]||(t[9]=e("p",null,[e("strong",null,"Endpoint:"),s(),e("code",null,"DELETE /:id"),e("strong",null,"File:"),s(),e("code",null,"delete-entity.ts"),e("strong",null,"Flow:")],-1)),a(n,null,{default:l(()=>[a(i,{code:"graph%20LR%0A%20%20%20%20A%5BRequest%5D%20--%3E%20B%7BValidate%20Params%7D%0A%20%20%20%20B%20--%3E%20C%5BDelete%20from%20DB%5D%0A%20%20%20%20C%20--%3E%20D%5BInvalidate%20Cache%5D%0A%20%20%20%20D%20--%3E%20E%5BReturn%20Empty%5D%0A%0A%20%20%20%20style%20C%20fill%3A%23f44336%2Cstroke%3A%23333%2Cstroke-width%3A2px%0A%20%20%20%20style%20D%20fill%3A%23f44336%2Cstroke%3A%23333%2Cstroke-width%3A2px%0A",showToolbar:"1"})]),_:1}),t[10]||(t[10]=o(`<p><strong>Action Features:</strong></p><ul><li><strong>Validation</strong>: All inputs validated with Zod schemas</li><li><strong>Caching</strong>: Redis-based caching with TTL (10 minutes)</li><li><strong>Cache Invalidation</strong>: Automatic cache clearing on mutations</li><li><strong>Prepared Statements</strong>: Optimized DB queries</li><li><strong>Error Handling</strong>: Proper HTTP status codes and i18n messages</li><li><strong>Type Safety</strong>: Full TypeScript inference</li></ul><h2 id="example-usage" tabindex="-1">Example Usage <a class="header-anchor" href="#example-usage" aria-label="Permalink to ‚ÄúExample Usage‚Äù">‚Äã</a></h2><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gen:domain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> category</span></span></code></pre></div><p><strong>Output:</strong></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>üöÄ Generating domain: category...</span></span>
<span class="line"><span>üîó Injected route into http-primary-webserver.ts</span></span>
<span class="line"><span></span></span>
<span class="line"><span>‚úÖ Domain &quot;category&quot; generated successfully!</span></span>
<span class="line"><span></span></span>
<span class="line"><span>üìÇ Created Files:</span></span>
<span class="line"><span>   - src/domain/category/entity.ts</span></span>
<span class="line"><span>   - src/domain/category/schema.ts</span></span>
<span class="line"><span>   - src/domain/category/routes.ts</span></span>
<span class="line"><span>   - src/domain/category/actions/...</span></span>
<span class="line"><span>   - tests/unit/domain/category/crud.spec.ts</span></span>
<span class="line"><span></span></span>
<span class="line"><span>üìç Location: src/domain/category</span></span>
<span class="line"><span></span></span>
<span class="line"><span>üëá Next Steps:</span></span>
<span class="line"><span>   1. Review the generated schema in src/domain/category/schema.ts</span></span>
<span class="line"><span>   2. Run migration if necessary: bun run db:migrate</span></span>
<span class="line"><span>   3. Run tests: bun test tests/unit/domain/category/crud.spec.ts</span></span>
<span class="line"><span></span></span>
<span class="line"><span>üé® Running formatter...</span></span>
<span class="line"><span>‚ú® Formatting complete!</span></span></code></pre></div><h3 id="what-s-created" tabindex="-1">What&#39;s Created <a class="header-anchor" href="#what-s-created" aria-label="Permalink to ‚ÄúWhat&#39;s Created‚Äù">‚Äã</a></h3><ul><li>‚úÖ Complete REST API with 5 endpoints</li><li>‚úÖ Database table with indexes</li><li>‚úÖ Request/response validation</li><li>‚úÖ Automatic caching layer</li><li>‚úÖ Swagger documentation</li><li>‚úÖ Test file skeleton</li><li>‚úÖ Type-safe operations</li></ul><h3 id="next-steps-after-generation" tabindex="-1">Next Steps After Generation <a class="header-anchor" href="#next-steps-after-generation" aria-label="Permalink to ‚ÄúNext Steps After Generation‚Äù">‚Äã</a></h3><ol><li><strong>Customize the entity</strong>: Add more columns to <code>columns</code> object in <code>entity.ts</code></li><li><strong>Enhance validation</strong>: Add custom rules in <code>schema.ts</code></li><li><strong>Write tests</strong>: Implement actual test cases in <code>crud.spec.ts</code></li><li><strong>Run migrations</strong>: Generate and run Drizzle migrations</li></ol><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Generate migration</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> db:migrate</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Apply to database</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> db:migrate:push</span></span></code></pre></div><h2 id="behavioral-notes" tabindex="-1">Behavioral Notes <a class="header-anchor" href="#behavioral-notes" aria-label="Permalink to ‚ÄúBehavioral Notes‚Äù">‚Äã</a></h2><ul><li><strong>Naming Convention</strong>: Use singular form (e.g., <code>product</code>, not <code>products</code>)</li><li><strong>Table Names</strong>: Automatically matches domain name</li><li><strong>Cache Keys</strong>: Generated using <code>tag()</code> helper with domain name</li><li><strong>Idempotent</strong>: Safe to re-run (will overwrite existing files)</li><li><strong>Automatic Injection</strong>: Routes are automatically registered in <code>http-primary-webserver.ts</code></li><li><strong>Auto-Formatting</strong>: Runs <code>biome format</code> automatically after generation</li><li><strong>No Conflicts</strong>: Each domain is isolated in its own folder</li></ul>`,13))])}const b=d(h,[["render",g]]);export{C as __pageData,b as default};

import{M as l}from"./chunks/theme.BUFF_Lox.js";import{I as c,c as g,o as y,aF as t,J as n}from"./chunks/framework.CZ2lsOHd.js";const f=JSON.parse('{"title":"Template System Architecture","description":"Zero-dependency template engine architecture and implementation details","frontmatter":{"title":"Template System Architecture","description":"Zero-dependency template engine architecture and implementation details"},"headers":[],"relativePath":"development/template-system-architecture.md","filePath":"development/template-system-architecture.md"}'),u={name:"development/template-system-architecture.md"},C=Object.assign(u,{setup(m){const s={type:"smoothstep",style:{stroke:"var(--vp-code-line-diff-add-symbol-color)",strokeWidth:2},animated:!0,markerEnd:l.ArrowClosed},i={type:"smoothstep",style:{stroke:"var(--vp-code-color)",strokeWidth:2},animated:!0,markerEnd:l.ArrowClosed},r=[{id:"a",type:"multi-handle",label:"User runs bun gen:domain",position:{x:0,y:-20}},{id:"b",type:"multi-handle",label:"generate-domain.ts",position:{x:25,y:150}},{id:"c",type:"multi-handle",label:"Load Templates",position:{x:40,y:300}},{id:"d",type:"multi-handle",label:"Replace Placeholders",position:{x:300,y:0}},{id:"e",type:"multi-handle",label:"Write to src/domain/",position:{x:304,y:150}},{id:"f",type:"multi-handle",label:"Auto-inject Routes",position:{x:311,y:300}},{id:"g",type:"multi-handle",label:"Biome Format",position:{x:329,y:440}}],h=[{id:"e1",source:"a",target:"b",sourceHandle:"bottom-source",targetHandle:"top",...s},{id:"e2",source:"b",target:"c",sourceHandle:"bottom-source",targetHandle:"top",...s},{id:"e3",source:"c",target:"d",sourceHandle:"bottom-source",targetHandle:"top",...s},{id:"e4",source:"d",target:"e",sourceHandle:"bottom-source",targetHandle:"top",...s},{id:"e5",source:"e",target:"f",sourceHandle:"bottom-source",targetHandle:"top",...s},{id:"e6",source:"f",target:"g",sourceHandle:"bottom-source",targetHandle:"top",...s}],p=[{id:"u",type:"multi-handle",label:"User",position:{x:0,y:-100}},{id:"cli",type:"multi-handle",label:"CLI",position:{x:200,y:0}},{id:"tmp",type:"multi-handle",label:"Templates",position:{x:450,y:0}},{id:"fs",type:"multi-handle",label:"File System",position:{x:450,y:100}},{id:"srv",type:"multi-handle",label:"Webserver",position:{x:189,y:150}}],o=[{id:"g1",source:"u",target:"cli",sourceHandle:"bottom-source",targetHandle:"left",label:"gen:domain",...s},{id:"g2",source:"cli",target:"tmp",sourceHandle:"right-source",targetHandle:"left",label:"Load",...i},{id:"g3",source:"tmp",target:"cli",sourceHandle:"left-source",targetHandle:"right",label:"Content",...i},{id:"g4",source:"cli",target:"fs",sourceHandle:"right-source",targetHandle:"left",label:"Write Files",...i},{id:"g5",source:"cli",target:"srv",sourceHandle:"bottom-source",targetHandle:"top",label:"Inject Route",...i},{id:"g6",source:"cli",target:"u",sourceHandle:"top-source",targetHandle:"right",label:"Done",...s}],d=[{id:"cmd",type:"multi-handle",label:"bun gen:domain",position:{x:350,y:0}},{id:"dir",type:"multi-handle",label:"src/domain/product/",position:{x:333,y:100}},{id:"ent",type:"multi-handle",label:"entity.ts",position:{x:100,y:250}},{id:"sch",type:"multi-handle",label:"schema.ts",position:{x:180,y:320}},{id:"rou",type:"multi-handle",label:"routes.ts",position:{x:300,y:380}},{id:"act",type:"multi-handle",label:"actions/",position:{x:500,y:250}},{id:"a1",type:"multi-handle",label:"get-by-id",position:{x:670,y:380}},{id:"a2",type:"multi-handle",label:"find-by-params",position:{x:570,y:440}},{id:"a3",type:"multi-handle",label:"post-new",position:{x:495,y:500}},{id:"sv",type:"multi-handle",label:"server.register",position:{x:279,y:500}}],k=[{id:"s1",source:"cmd",target:"dir",sourceHandle:"bottom-source",targetHandle:"top",...s},{id:"s2",source:"dir",target:"ent",sourceHandle:"bottom-source",targetHandle:"top",...s},{id:"s3",source:"dir",target:"sch",sourceHandle:"bottom-source",targetHandle:"top",...s},{id:"s4",source:"dir",target:"rou",sourceHandle:"bottom-source",targetHandle:"top",...s},{id:"s5",source:"dir",target:"act",sourceHandle:"bottom-source",targetHandle:"top",...i},{id:"s6",source:"act",target:"a1",sourceHandle:"right-source",targetHandle:"top",...i},{id:"s7",source:"act",target:"a2",sourceHandle:"bottom-source",targetHandle:"top",...i},{id:"s8",source:"act",target:"a3",sourceHandle:"bottom-source",targetHandle:"top",...i},{id:"s9",source:"rou",target:"sv",sourceHandle:"bottom-source",targetHandle:"top",...s}];return(E,e)=>{const a=c("InteractiveFlow");return y(),g("div",null,[e[0]||(e[0]=t('<h1 id="template-system-architecture" tabindex="-1">Template System Architecture <a class="header-anchor" href="#template-system-architecture" aria-label="Permalink to “Template System Architecture”">​</a></h1><p>The boilerplate includes a <strong>powerful, zero-dependency template engine</strong> that generates complete CRUD domains in seconds. Unlike traditional code generators that use string concatenation or external libraries, this system uses <strong>native TypeScript files as templates</strong> with intelligent placeholder replacement.</p><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to “Overview”">​</a></h2><p>The template system is designed with three core principles:</p><ol><li><strong>Zero Dependencies</strong>: No external template libraries (Handlebars, EJS, etc.)</li><li><strong>Developer Experience</strong>: Templates are valid TypeScript files with full IDE support</li><li><strong>Extensibility</strong>: Easy to add new generators (Auth, WebSockets, etc.)</li></ol><h2 id="architecture" tabindex="-1">Architecture <a class="header-anchor" href="#architecture" aria-label="Permalink to “Architecture”">​</a></h2>',6)),n(a,{nodes:r,edges:h}),e[1]||(e[1]=t(`<h2 id="template-directory-structure" tabindex="-1">Template Directory Structure <a class="header-anchor" href="#template-directory-structure" aria-label="Permalink to “Template Directory Structure”">​</a></h2><p>Templates are organized in <code>src/templates/domain/</code> and mirror the output structure:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>src/templates/domain/</span></span>
<span class="line"><span>├── entity.ts              # Database table definition</span></span>
<span class="line"><span>├── schema.ts              # Zod validation schemas</span></span>
<span class="line"><span>├── routes.ts              # Fastify route handlers</span></span>
<span class="line"><span>└── actions/</span></span>
<span class="line"><span>    ├── get-by-id.ts       # Find by ID action</span></span>
<span class="line"><span>    ├── get-find-by-params.ts  # Search with filters</span></span>
<span class="line"><span>    ├── post-new-entity.ts     # Create new record</span></span>
<span class="line"><span>    ├── put-update-entity.ts   # Update existing</span></span>
<span class="line"><span>    └── delete-entity.ts       # Delete record</span></span></code></pre></div><h2 id="why-typescript-templates" tabindex="-1">Why TypeScript Templates? <a class="header-anchor" href="#why-typescript-templates" aria-label="Permalink to “Why TypeScript Templates?”">​</a></h2><p>Instead of using <code>.hbs</code> or <code>.ejs</code> files (which require extensions for syntax highlighting), we use <strong>valid TypeScript files</strong> with special placeholders.</p><h3 id="before-template" tabindex="-1">Before (Template) <a class="header-anchor" href="#before-template" aria-label="Permalink to “Before (Template)”">​</a></h3><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/templates/domain/entity.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __name__</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> pgTable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;__name__&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">columns, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">identifier });</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __name__;</span></span></code></pre></div><h3 id="after-generation" tabindex="-1">After Generation <a class="header-anchor" href="#after-generation" aria-label="Permalink to “After Generation”">​</a></h3><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/domain/pokemon/entity.ts (after bun gen:domain pokemon)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> pokemon</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> pgTable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;pokemon&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">columns, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">identifier });</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pokemon;</span></span></code></pre></div><h3 id="benefits" tabindex="-1">Benefits <a class="header-anchor" href="#benefits" aria-label="Permalink to “Benefits”">​</a></h3><table tabindex="0"><thead><tr><th>Feature</th><th>TypeScript Templates</th><th>Traditional (.hbs/.ejs)</th></tr></thead><tbody><tr><td><strong>Syntax Highlighting</strong></td><td>✅ Native in IDE</td><td>❌ Requires extension</td></tr><tr><td><strong>Auto-formatting</strong></td><td>✅ Biome/Prettier works</td><td>❌ Manual formatting</td></tr><tr><td><strong>Type Checking</strong></td><td>✅ Catch errors early</td><td>❌ Runtime errors only</td></tr><tr><td><strong>Dependencies</strong></td><td>✅ Zero</td><td>❌ Requires library</td></tr><tr><td><strong>Learning Curve</strong></td><td>✅ Just TypeScript</td><td>⚠️ New syntax to learn</td></tr></tbody></table><h2 id="generation-flow" tabindex="-1">Generation Flow <a class="header-anchor" href="#generation-flow" aria-label="Permalink to “Generation Flow”">​</a></h2>`,12)),n(a,{nodes:p,edges:o}),e[2]||(e[2]=t(`<h2 id="placeholder-system" tabindex="-1">Placeholder System <a class="header-anchor" href="#placeholder-system" aria-label="Permalink to “Placeholder System”">​</a></h2><p>The template engine uses a simple regex-based replacement:</p><table tabindex="0"><thead><tr><th>Placeholder</th><th>Example Input</th><th>Output</th><th>Usage</th></tr></thead><tbody><tr><td><code>__name__</code></td><td><code>pokemon</code></td><td><code>pokemon</code></td><td>Variable names, table names, lowercase references</td></tr><tr><td><code>__Capitalized__</code></td><td><code>pokemon</code></td><td><code>Pokemon</code></td><td>Class names, display labels, OpenAPI tags</td></tr></tbody></table><h3 id="implementation" tabindex="-1">Implementation <a class="header-anchor" href="#implementation" aria-label="Permalink to “Implementation”">​</a></h3><p>The entire rendering engine is just 3 lines of code:</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> render</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">content</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vars</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Record</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  content</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">replace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">__name__</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">g</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, vars.name)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">replace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">__Capitalized__</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">g</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, vars.capitalized);</span></span></code></pre></div><p><strong>Why this works:</strong></p><ul><li><code>__name__</code> is a valid JavaScript identifier (no syntax errors)</li><li>Global regex replacement (<code>/g</code> flag) handles all occurrences</li><li>No parsing or AST manipulation needed</li></ul><h2 id="what-gets-generated" tabindex="-1">What Gets Generated <a class="header-anchor" href="#what-gets-generated" aria-label="Permalink to “What Gets Generated”">​</a></h2><p>Running <code>bun gen:domain product</code> creates a complete, production-ready CRUD module:</p>`,10)),n(a,{nodes:d,edges:k}),e[3]||(e[3]=t(`<h3 id="generated-files" tabindex="-1">Generated Files <a class="header-anchor" href="#generated-files" aria-label="Permalink to “Generated Files”">​</a></h3><ul><li><strong><code>entity.ts</code></strong>: Drizzle ORM table definition with columns, indexes, and types</li><li><strong><code>schema.ts</code></strong>: Zod schemas for validation (create, update, read, delete)</li><li><strong><code>routes.ts</code></strong>: 5 Fastify routes (GET, POST, PUT, DELETE) with OpenAPI docs</li><li><strong><code>actions/</code></strong>: Business logic for each operation with caching and error handling</li></ul><h2 id="automatic-route-registration" tabindex="-1">Automatic Route Registration <a class="header-anchor" href="#automatic-route-registration" aria-label="Permalink to “Automatic Route Registration”">​</a></h2><p>The generator intelligently injects the new routes into your webserver:</p><p><strong>Before:</strong></p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/functions/http-primary-webserver.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userRoutes </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@domain/user/routes&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> server</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> webserver.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">server.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">register</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userRoutes, { prefix: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/api/v1/users&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span></code></pre></div><p><strong>After <code>bun gen:domain pokemon</code>:</strong></p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/functions/http-primary-webserver.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userRoutes </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@domain/user/routes&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pokemonRoutes </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@domain/pokemon/routes&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ← Auto-added</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> server</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> webserver.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">server.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">register</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userRoutes, { prefix: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/api/v1/users&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">server.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">register</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pokemonRoutes, { prefix: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/api/v1/pokemons&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ← Auto-added</span></span></code></pre></div><h3 id="injection-algorithm" tabindex="-1">Injection Algorithm <a class="header-anchor" href="#injection-algorithm" aria-label="Permalink to “Injection Algorithm”">​</a></h3><p>The generator uses a simple string manipulation approach:</p><ol><li><strong>Find last import</strong>: Search for <code>lastIndexOf(&quot;import &quot;)</code></li><li><strong>Insert new import</strong>: Add after the last import line</li><li><strong>Find last register</strong>: Search for <code>lastIndexOf(&quot;server.register(&quot;)</code></li><li><strong>Insert new register</strong>: Add after the last register call</li></ol><p>This approach is:</p><ul><li>✅ Simple and reliable</li><li>✅ Doesn&#39;t require AST parsing</li><li>✅ Works with any code style</li><li>⚠️ Assumes consistent patterns (which the boilerplate enforces)</li></ul><h2 id="extending-the-template-system" tabindex="-1">Extending the Template System <a class="header-anchor" href="#extending-the-template-system" aria-label="Permalink to “Extending the Template System”">​</a></h2><p>The architecture is designed to scale from simple CRUD to complex plugin systems.</p><h3 id="adding-new-generators" tabindex="-1">Adding New Generators <a class="header-anchor" href="#adding-new-generators" aria-label="Permalink to “Adding New Generators”">​</a></h3><p>Want to add authentication or WebSocket support? Just create new templates:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">src/templates/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> domain/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # Existing CRUD templates</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> auth/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            # New: Authentication templates</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> middleware.ts</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jwt-service.ts</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> routes.ts</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> websocket/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       # New: WebSocket templates</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> handler.ts</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> events.ts</span></span></code></pre></div><p>Then create a new generator command:</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/commands/generate-auth.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> templates</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  middleware: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> loadTemplate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;auth/middleware.ts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  service: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> loadTemplate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;auth/jwt-service.ts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  routes: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> loadTemplate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;auth/routes.ts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Render and write files...</span></span></code></pre></div><h3 id="using-anchors-for-complex-injection" tabindex="-1">Using Anchors for Complex Injection <a class="header-anchor" href="#using-anchors-for-complex-injection" aria-label="Permalink to “Using Anchors for Complex Injection”">​</a></h3><p>For more complex scenarios (like injecting middleware into existing files), use <strong>comment anchors</strong>:</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/functions/http-primary-webserver.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> server</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> webserver.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// [CLI:Inject_Middleware]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Generators can search for this comment and inject code below it</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">server.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">register</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userRoutes, { prefix: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/api/v1/users&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span></code></pre></div><p>Generator code:</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> anchorIndex</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> content.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">indexOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;// [CLI:Inject_Middleware]&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> insertPoint</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> content.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">indexOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, anchorIndex) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">content </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> content.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">slice</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, insertPoint) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newMiddleware </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> content.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">slice</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(insertPoint);</span></span></code></pre></div><h2 id="best-practices" tabindex="-1">Best Practices <a class="header-anchor" href="#best-practices" aria-label="Permalink to “Best Practices”">​</a></h2><h3 id="template-design" tabindex="-1">Template Design <a class="header-anchor" href="#template-design" aria-label="Permalink to “Template Design”">​</a></h3><ol><li><strong>Keep templates valid TypeScript</strong>: Ensures IDE support and type checking</li><li><strong>Use descriptive placeholders</strong>: <code>__name__</code> is clear, <code>__x__</code> is not</li><li><strong>Include comments</strong>: Explain complex logic in templates</li><li><strong>Test templates</strong>: Generate a test domain and verify output</li></ol><h3 id="generator-design" tabindex="-1">Generator Design <a class="header-anchor" href="#generator-design" aria-label="Permalink to “Generator Design”">​</a></h3><ol><li><strong>Validate input</strong>: Check domain name format before generation</li><li><strong>Handle errors gracefully</strong>: What if file already exists?</li><li><strong>Provide feedback</strong>: Show what was created and next steps</li><li><strong>Auto-format output</strong>: Always run Biome after generation</li></ol><h3 id="maintenance" tabindex="-1">Maintenance <a class="header-anchor" href="#maintenance" aria-label="Permalink to “Maintenance”">​</a></h3><ol><li><strong>Version templates</strong>: Consider git-tagging template versions</li><li><strong>Document changes</strong>: Update this Wiki when templates change</li><li><strong>Test after updates</strong>: Regenerate a test domain after template edits</li></ol><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to “Troubleshooting”">​</a></h2><h3 id="templates-not-found" tabindex="-1">Templates not found <a class="header-anchor" href="#templates-not-found" aria-label="Permalink to “Templates not found”">​</a></h3><p><strong>Error:</strong> <code>ENOENT: no such file or directory</code></p><p><strong>Solution:</strong> Ensure templates exist in <code>src/templates/domain/</code></p><h3 id="placeholder-not-replaced" tabindex="-1">Placeholder not replaced <a class="header-anchor" href="#placeholder-not-replaced" aria-label="Permalink to “Placeholder not replaced”">​</a></h3><p><strong>Error:</strong> Generated file contains <code>__name__</code> instead of actual name</p><p><strong>Solution:</strong> Check the <code>render()</code> function is being called with correct variables</p><h3 id="route-not-auto-injected" tabindex="-1">Route not auto-injected <a class="header-anchor" href="#route-not-auto-injected" aria-label="Permalink to “Route not auto-injected”">​</a></h3><p><strong>Error:</strong> New domain works but route not in webserver</p><p><strong>Solution:</strong> Verify <code>http-primary-webserver.ts</code> follows expected pattern (imports at top, registers after <code>webserver.create()</code>)</p><h2 id="future-enhancements" tabindex="-1">Future Enhancements <a class="header-anchor" href="#future-enhancements" aria-label="Permalink to “Future Enhancements”">​</a></h2><p>Potential improvements to the template system:</p><ol><li><strong>Interactive Mode</strong>: Prompt for column types during generation</li><li><strong>Template Variants</strong>: Choose between REST, GraphQL, or gRPC templates</li><li><strong>Custom Hooks</strong>: Allow users to define pre/post generation scripts</li><li><strong>Template Marketplace</strong>: Share community templates</li><li><strong>Migration Generator</strong>: Auto-generate Drizzle migrations from templates</li></ol><hr><p><strong>See Also:</strong></p><ul><li><a href="/TypeScript-Boilerplate/development/domain-scaffolding.html">Domain Scaffolding (Generator)</a> - How to use the generator</li><li><a href="/TypeScript-Boilerplate/architecture/">Architecture</a> - Overall project structure</li><li><a href="/TypeScript-Boilerplate/development/best-practices.html">Best Practices</a> - Coding standards</li></ul>`,48))])}}});export{f as __pageData,C as default};
